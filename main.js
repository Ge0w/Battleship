(()=>{"use strict";const t=(t,e,s)=>{let i=0;const r=[[],[]];for(let t=0;t<e;t++)r[0].push(0+t),r[1].push(s*t);return{name:t,directions:r,hit:()=>{i++},isSunk:()=>{i===e&&(i=10)},hits:i}},e=()=>({createBoard:(t,e)=>{for(let s=0;s<100;s++){const i=document.createElement("div");i.dataset.id=s,t.appendChild(i),e.push(i)}},ships:[t("destroyer",2,10),t("submarine",3,10),t("cruiser",3,10),t("battleship",4,10),t("carrier",5,10)]});document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".user-grid"),s=document.querySelector(".computer-grid"),i=document.querySelector(".grid-display"),r=document.querySelectorAll(".ship"),n=document.querySelector(".destroyer-container"),o=document.querySelector(".submarine-container"),a=document.querySelector(".cruiser-container"),c=document.querySelector(".battleship-container"),l=document.querySelector(".carrier-container"),h=document.querySelector("#start"),d=document.querySelector("#rotate"),u=document.querySelector("#restart"),p=document.querySelector("#whose-go"),m=document.querySelector("#info"),y=document.querySelectorAll(".info-text"),f=(document.querySelector(".setup-buttons"),document.querySelector("#scoreboard"));let L=0,g=0,v=[],b=!1,E=!0,k=!1,C="user",S=[],q=[],x="",$=!1,I=-1;const Y=e(),M=e();Y.createBoard(t,S),M.createBoard(s,q);const A=t=>{let e,s=Math.floor(Math.random()*t.directions.length),i=t.directions[s];0===s&&(e=1),1===s&&(e=10);let r=Math.abs(Math.floor(Math.random()*q.length-t.directions[0].length*e));const n=i.some((t=>q[r+t].classList.contains("taken"))),o=i.some((t=>(r+t)%10==9)),a=i.some((t=>(r+t)%10==0));n||o||a?A(t):i.forEach((e=>q[r+e].classList.add("taken",t.name)))},P=()=>{if($){if(b){if(k)return;"user"===C&&(p.textContent="Your Go",q.forEach((t=>t.addEventListener("click",(function(e){I=t.dataset.id,z(t.classList)})))))}else{if(x="singlePlayer",b=!0,A(M.ships[0]),A(M.ships[1]),A(M.ships[2]),A(M.ships[3]),A(M.ships[4]),h.style.display="none",d.style.display="none",k)return;"user"===C&&(p.textContent="Your Go",y.forEach((t=>t.style.display="block")),q.forEach((t=>t.addEventListener("click",(function(e){I=t.dataset.id,z(t.classList)})))))}"enemy"===C&&(p.textContent="Computers Go",setTimeout(T,1e3))}else alert("Place all ships!")};let U,G,B;function D(){G=this,B=this.children.length}function O(t){t.preventDefault()}function w(t){t.preventDefault()}function N(){}function W(){let t=G.lastElementChild.id,e=t.slice(0,-2),s=parseInt(t.substr(-1)),r=s+parseInt(this.dataset.id),n=[0,10,20,30,40,50,60,70,80,90,1,11,21,31,41,51,61,71,81,91,2,22,32,42,52,62,72,82,92,3,13,23,33,43,53,63,73,83,93].splice(0,10*s),o=[99,98,97,96,95,94,93,92,91,90,89,88,87,86,85,84,83,82,81,80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60].splice(0,10*s),a=parseInt(U.substr(-1));r-=a;let c=!0;if(E){for(let t=0;t<B;t++)if(S[parseInt(this.dataset.id)-a+t].classList.contains("taken")){c=!1;break}}else for(let t=0;t<B;t++)if(S[parseInt(this.dataset.id)-a+10*t].classList.contains("taken")){c=!1;break}if(E&&!n.includes(r)&&c)for(let t=0;t<B;t++){let s;0===t&&(s="start"),t===B-1&&(s="end"),S[parseInt(this.dataset.id)-a+t].classList.add("taken","horizontal",e,s)}else{if(E||o.includes(r)||!c)return;for(let t=0;t<B;t++){let s;0===t&&(s="start"),t===B-1&&(s="end"),S[parseInt(this.dataset.id)-a+10*t].classList.add("taken","vertical",e,s)}}v.push(G),i.removeChild(G),i.querySelector(".ship")||($=!0)}function j(){}h.addEventListener("click",P),d.addEventListener("click",(()=>E?(n.classList.toggle("destroyer-container-vertical"),o.classList.toggle("submarine-container-vertical"),a.classList.toggle("cruiser-container-vertical"),c.classList.toggle("battleship-container-vertical"),l.classList.toggle("carrier-container-vertical"),void(E=!1)):E?void 0:(n.classList.toggle("destroyer-container-vertical"),o.classList.toggle("submarine-container-vertical"),a.classList.toggle("cruiser-container-vertical"),c.classList.toggle("battleship-container-vertical"),l.classList.toggle("carrier-container-vertical"),void(E=!0)))),r.forEach((t=>t.addEventListener("dragstart",D))),S.forEach((t=>t.addEventListener("dragstart",D))),S.forEach((t=>t.addEventListener("dragover",O))),S.forEach((t=>t.addEventListener("dragenter",w))),S.forEach((t=>t.addEventListener("dragleave",N))),S.forEach((t=>t.addEventListener("drop",W))),S.forEach((t=>t.addEventListener("dragend",j))),r.forEach((t=>{t.addEventListener("mousedown",(t=>{U=t.target.id}))}));const z=t=>{const e=s.querySelector(`div[data-id='${I}']`),i=Object.values(t);if(!e.classList.contains("boom")&&"user"===C&&!k){if(i.includes("destroyer")&&M.ships[0].hits++,i.includes("submarine")&&M.ships[1].hits++,i.includes("cruiser")&&M.ships[2].hits++,i.includes("battleship")&&M.ships[3].hits++,i.includes("carrier")&&M.ships[4].hits++,i.includes("taken")?e.classList.add("boom"):e.classList.add("miss"),i.includes("miss"))return;H(),C="enemy","singlePlayer"===x&&P()}},T=t=>{if("singlePlayer"===x&&(t=Math.floor(Math.random()*S.length)),S[t].classList.contains("boom"))"singlePlayer"===x&&T();else{const e=S[t].classList.contains("taken");S[t].classList.add(e?"boom":"miss"),S[t].classList.contains("destroyer")&&Y.ships[0].hits++,S[t].classList.contains("submarine")&&Y.ships[1].hits++,S[t].classList.contains("cruiser")&&Y.ships[2].hits++,S[t].classList.contains("battleship")&&Y.ships[3].hits++,S[t].classList.contains("carrier")&&Y.ships[4].hits++,H()}C="user",p.textContent="Your Go"};function F(t){return t.charAt(0).toUpperCase()+t.slice(1)}const H=()=>{let t="computer";2===M.ships[0].hits&&(m.textContent="You sunk the computer's destroyer",M.ships[0].hits=10),3===M.ships[1].hits&&(m.textContent="You sunk the computer's submarine",M.ships[1].hits=10),3===M.ships[2].hits&&(m.textContent="You sunk the computer's cruiser",M.ships[2].hits=10),4===M.ships[3].hits&&(m.textContent="You sunk the computer's battleship",M.ships[3].hits=10),5===M.ships[4].hits&&(m.textContent="You sunk the computer's carrier",M.ships[4].hits=10),2===Y.ships[0].hits&&(m.textContent=`${F(t)} sunk your destroyer`,Y.ships[0].hits=10),3===Y.ships[1].hits&&(m.textContent=`${F(t)} sunk your submarine`,Y.ships[1].hits=10),3===Y.ships[2].hits&&(m.textContent=`${F(t)} sunk your cruiser`,Y.ships[2].hits=10),4===Y.ships[3].hits&&(m.textContent=`${F(t)} sunk your battleship`,Y.ships[3].hits=10),5===Y.ships[4].hits&&(m.textContent=`${F(t)} sunk your carrier`,Y.ships[4].hits=10),M.ships[0].hits+M.ships[1].hits+M.ships[2].hits+M.ships[3].hits+M.ships[4].hits===50&&(m.textContent="YOU WIN",L++,f.textContent=`User Score: ${L} | Computer Score: ${g}`,J()),Y.ships[0].hits+Y.ships[1].hits+Y.ships[2].hits+Y.ships[3].hits+Y.ships[4].hits===50&&(m.textContent=`${t.toUpperCase()} WINS`,g++,f.textContent=`User Score: ${L} | Computer Score: ${g}`,J())},J=()=>{k=!0,p.textContent="",u.style.display="inline-block",y.forEach((t=>t.style.display="none"))};u.addEventListener("click",(()=>{Y.ships.forEach((t=>t.hits=0)),M.ships.forEach((t=>t.hits=0)),u.style.display="none",h.style.display="inline-block",d.style.display="inline-block",k=!1,m.textContent="",v.forEach((t=>{i.append(t)})),v=[],$=!1,b=!1,C="user";const e=s.querySelectorAll(".taken, .miss, .boom"),r=t.querySelectorAll(".taken, .miss, .boom");e.forEach((t=>t.classList.remove(...t.classList))),r.forEach((t=>t.classList.remove(...t.classList)))}))}))})();